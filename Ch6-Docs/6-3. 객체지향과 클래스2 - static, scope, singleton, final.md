# 6-3. 객체지향과 클래스2 - static, scope, singleton, final

## static

- 프로그램이 실행되어 메모리에 올라갔을 때 딱 한 번 메모리 공간이 할당 됨. 그리고 그 값은 모든 인스턴스가 공유함.

- 정적 변수

```java
static int serialNum;
```

- 사용

```java
package StaticEX;

/**
 * static 사용
 */
public class Student {
    public static int serialNum = 1000; //static 변수는 인스턴스 생성과 무관하게 먼저 생성됨
    public int studentID;
    public String studentName;
    public int grade;
    public String address;

    public String getStudentName(){
        return studentName;
    }

    public void setStudentName(String name){
        studentName = name;
    }
}


package StaticEX;

public class StudentTest1 {
    public static void main(String[] args) {
        Student student = new Student();
        student.setStudentName("walter");
        System.out.println(student.serialNum); //serialNum 변수의 초깃값 출력
        student.serialNum++; //static 변수 값 증가

        Student student2 = new Student();
        student2.setStudentName("walter2");
        //증가된 값 출력
        System.out.println(student2.serialNum);
        System.out.println(student2.serialNum);
    }
}

/*
결과
1000
1001
1001
*/
```

- 자동으로 학번생성

```java
package StaticEX;

/**
 * static 사용
 */
public class Student {
    public static int serialNum = 1000; //static 변수는 인스턴스 생성과 무관하게 먼저 생성됨
    public int studentID;
    public String studentName;
    public int grade;
    public String address;


    //자동으로 학번생성
    public Student(){
        serialNum++;
        studentID = serialNum;
    }

    public String getStudentName(){
        return studentName;
    }

    public void setStudentName(String name){
        studentName = name;
    }
}

package StaticEX;

public class StudentTest1 {
    public static void main(String[] args) {
        Student student = new Student();
        student.setStudentName("walter");
        System.out.println(student.serialNum);
        System.out.println(student.studentName + " 학번:" + student.studentID);


        Student student2 = new Student();
        student2.setStudentName("walter2");
        System.out.println(student2.serialNum);
        System.out.println(student2.studentName + " 학번:" + student2.studentID);
    }
}
/*
결과
1001
walter 학번:1001
1002
walter2 학번:1002
*/
```

## 클래스 변수

- static은 인스턴스를 만들기 전에 메모리 공간에 할당되므로 인스턴스를 생성하지 않아도 접근이 가능함
- Student.serialNum; 처럼 Student 클래스로 직접 serialNum에 접근

## 클래스 메소드(static method)

- serialNum 변수를 사용하는 메소드
  - 외부 클래스에서 serialNum 변수를 직접 참조하지 못하도록 private로 선언 후 get(), set() 메소드 생성

```java
package StaticEX;

/**
 * static 사용
 */
public class Student2 {
    private static int serialNum = 1000; //static 변수는 인스턴스 생성과 무관하게 먼저 생성됨. private
    public int studentID;
    public String studentName;
    public int grade;
    public String address;


    //자동으로 학번생성
    public Student2(){
        serialNum++;
        studentID = serialNum;
    }

    public String getStudentName(){
        return studentName;
    }

    public void setStudentName(String name){
        studentName = name;
    }

    public static int getSerialNum(){
        int i = 10;
        return serialNum;
    }

    public static void setSerialNum(int serialNum) {
        Student2.serialNum = serialNum;
    }
}

package StaticEX;

public class StudentTest4 {
    public static void main(String[] args) {
        Student2 student = new Student2();
        student.setStudentName("walter");

        System.out.println(Student2.getSerialNum());
        System.out.println(student.studentName + " 학번:" + student.studentID);


        Student student2 = new Student();
        student2.setStudentName("walter2");
        System.out.println(Student2.getSerialNum());
        System.out.println(student2.studentName + " 학번:" + student2.studentID);
    }
}

/*
결과
1001
walter 학번:1001
1001
walter2 학번:1001
*/
```

- 클래스 내부에서는 인스턴스 변수를 사용할 수 없음

```java
public class Student2 {
    private static int serialNum = 1000; //static 변수는 인스턴스 생성과 무관하게 먼저 생성됨. private
    public int studentID;
    public String studentName;
    public int grade;
    public String address;
  
  	...
    public static int getSerialNum(){
	     int i = 10; //메소드 안에서 선언 => 사용가능
  	   studentName = "walter"; //오류발생. serialNum의 get()메소드. 인스턴스가 생성될 때 만들어지는 인스턴스 변수이므로 사용할 수 없음
       return serialNum;
    }
}
```

### 나 혼자 코딩

```java
package SelfCoding;

/**
 * 나 혼자 코딩
 * 학생마다 각각 다른 학생카드가 발급됩니다. 학생 카드 번호는 학번에 100을 더한 값
 * Sutdent3 클래스를 만들어 학생 카드 번호 멤버 변수를 추가하고, 학생이 생성될 때마다 학생 카드 번호를 부여
 * StudentTest6 클래스를 만들어 학생 두 명을 생성.
 * 두 학생의 카드 번호를 출력.
 */

public class Student3 {
    private static int serialNum =  1000;
    int studentID; //학번
    String studentName;
    int cardNum; //카드 번호 => 학번 + 100



    Student3(){
        //학번은 serialNum에서 1씩 증가
        serialNum++;
        studentID = serialNum;
        cardNum = studentID + 100;
    }

    public int getStudentID() {
        return studentID;
    }

    public void setStudentID(int studentID) {
        this.studentID = studentID;
    }

    public String getStudentName() {
        return studentName;
    }

    public void setStudentName(String studentName) {
        this.studentName = studentName;
    }

    public int getCardNum() {
        return cardNum;
    }

    public void setCardNum(int cardNum) {
        this.cardNum = cardNum;
    }

}

package SelfCoding;

public class StudentTest6 {

    public static void main(String[] args) {
        Student3 student = new Student3();
        student.setStudentName("walter");
        System.out.println(student.studentName + " 학번: " + student.studentID + "카드번호 :" + student.cardNum);

        Student3 student2 = new Student3();
        student2.setStudentName("walter2");
        System.out.println(student2.studentName + " 학번: " + student2.studentID + "카드번호 :" + student2.cardNum);
    }


}

/*
결과
walter 학번: 1000카드번호 :1100
walter2 학번: 1001카드번호 :1101
*/
```

## scope

- 지역변수 : 함수나 메소드 내부에 선언
  - 다른 함수에서 사용 불가
  - 지역 변수가 생성되는 메모리 : 스택
  - 스택에 생성되는 지역변수는 함수가 호출될 때 성성되었다가 함수가 반환되면 메모리 공간 반환
-  멤버변수 : 인스턴스 변수
  - 클래스 어느 메소드에서나 사용 가능
  - 힙에 생성된 인스턴스. Garbage Collector에 의해 해제
  - 클래스 내부에의 여러 메소드에서 사용할 변수는 멤버 변수로 사용하는 것이 좋음
- static 변수 : 클래스변수
  - 프로그램 실행 시 메모리에 할당
  - 인스턴스가 생성되기 전에 할당되므로 클래스를 이용하여 사용 가능
  - 처음부터 데이터 영역에 메모리 생성

## final (자바의 정석)

- 사용될 수 있는 곳
  - 클래스 : 상속을 할 수 없게 함(다른 클래스의 조상이 될 수 없음)
  - 메소드 : 오버라이딩을 할 수 없게 함(재정의를 막음)
  - 멤버변수 : 상수로 만듦
  - 지역변수 : 상수로 만듦
- 인스턴스 변수의 경우, 생성자 호출시 단 한번 초기화 가능

```java
class Card{
  final int NUMBER; //상수지만 선언과 함께 초기화 하지 않고 생성자에서 단 한번 초기화 가능
  static int width = 100;
  
  Card(String num){
    Number = num; //단 한번 초기화
  }
}
```



## static 응용 - 싱글톤 패턴

### 싱글톤 패턴

- 단 하나의 인스턴스만 필요한 경우

```java
package Singleton;

public class Company {

    //유일하게 생성한 인스턴스
    private static Company instance = new Company();

    private Company(){}

    //외부에서 참조할 수 있는 public 메소드
    public static Company getInstance() {
        if(instance == null){
            instance = new Company();
        }

        return instance; //유일하게 생성한 인스턴스
    }
}

package Singleton;

public class CompanyTest {
    public static void main(String[] args) {
        Company myCompany1 = Company.getInstance();
        Company myCompany2 = Company.getInstance();

        System.out.println(myCompany1 == myCompany2);

    }

}

/*
결과
true
*/
```

### 나 혼자 코딩

- 유일 객체인 자동차 공장에서 차를 생산하는 메소드가 필요
- 

```java
/**
 * 나 혼자 코딩
 * 자동차 공장은 유일한 객체이고, 이 공장에서 생상되는 자동차는 제작될 때마다 고유번호가 부여됨
 * 자동차 번호가 10001부터 시작하여 1씩 증가
 * 공장 클래스와 자동차 클래스, CarFactoryTest필요
 */
public class CarFactoryTest {

    public static void main(String[] args) {
        CarFactory factory = CarFactory.getInstance(); //싱글톤 패턴
        Car mySonata = factory.createCar(); //메소드에서 Car 생성
        Car yourSonata = factory.createCar();

        System.out.println(mySonata.getCarNum()); //10001 출력
        System.out.println(yourSonata.getCarNum()); //10002 출력
    }
}



package SelfCoding.SingletoneCar;

public class Car {

    private static int serialNumber = 10001;
    int carNum;
    String carName;


    public Car() {
        serialNumber++;
        carNum = serialNumber;
    }


    public int getCarNum() {
        return carNum;
    }

    public void setCarNum(int carNumber) {
        this.carNum = carNumber;
    }

}

package SelfCoding.SingletoneCar;

public class CarFactory {

    //유일하게 생성한 인스턴스
    private static CarFactory instance = new CarFactory();

    private CarFactory() {}

    public static CarFactory getInstance(){

        if(instance == null){
            instance = new CarFactory();
        }
        return instance;
    }


    public Car createCar() {
        Car car = new Car();
        return car;
    }
}

```

