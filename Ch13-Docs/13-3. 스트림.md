# 13-3. 스트림

- 자료가 모여있는 컬렉션을 일련의 과정으로 처리하는 기능

```java
int[] arr = {1, 2, 3, 4, 5};
Arrays.stream(arr).forEach(n -> System.out.println(n));
```

## 스트림 연산

- 중간 연산
  - filter(), map()
- 최종 연산
  - 마지막에 한번만 호출
  - forEach(), count(), sum(), reduce()

```java
package stream;

import java.util.Arrays;

public class InArrayTest {

    public static void main(String[] args) {
        int[] arr = {1, 2, 3, 4, 5};

        int sumVal = Arrays.stream(arr).sum();
        //count() 메서드의 반환값은 long타입이므로 int로 다운캐스팅
        int count = (int)Arrays.stream(arr).count();

        System.out.println(sumVal);
        System.out.println(count);
    }
}
/*
15
5
*/
```

- ArrayList로 스트림 활용

```java
package stream;

import java.util.ArrayList;
import java.util.List;
import java.util.stream.Stream;

public class ArrayListStreamTest {
    public static void main(String[] args) {
        List<String> sList = new ArrayList<String>();
        sList.add("Tomas");
        sList.add("Edward");
        sList.add("Jack");

        Stream<String> stream = sList.stream();
        stream.forEach(s-> System.out.print(s + " "));
        System.out.println();

        sList.stream().sorted().forEach(s-> System.out.println (s));

    }
}
/*
Tomas Edward Jack 
Edward
Jack
Tomas
*/
```

## 스트림의 특징

- 자료의 대상과 관계 없이 동일한 연산을 수행한다.
- 한 번 생성하고 사용한 스트림은 재사용 할 수 없다.
- 스트림의 연산은 기존 자료를 변경하지 않는다.
- 스트림의 연산은 중간 연산과 최종 연산이 있다.

## 프로그래머가 기능을 지정하는 reduce() 연산

- 내부적으로 스트림의 요소를 소모하면서 프로그래머가 직접 지정한 기능을 수행합니다.

```java
//T reduce(T identify, BinaryOperator<T> accumulator)
//reduce(초깃값, 수행 기능(람다식으로 가능))

//두 요소의 값구하기
Arrays.stream(arr).reduce(0, (a,b)-> a+b))
```

```java
package stream.reduce;

import java.util.Arrays;
import java.util.function.BinaryOperator;

//BinaryOperator 구현
class ComparString implements BinaryOperator<String>{

    @Override
    public String apply(String s1, String s2) {
        if(s1.getBytes().length >= s2.getBytes().length) return s1;
        else return s2;
    }
}

public class ReduceTest {
    public static void main(String[] args) {
        String[] greetings = {"안녕하세요~~~~~", "hello", "Good Morning", "반갑습니다."};
        //람다식으로 구현
        System.out.println(Arrays.stream(greetings).reduce("", (s1, s2) -> {
            if(s1.getBytes().length >= s2.getBytes().length)
                return s1;
            else return s2;
        }));

        String str = Arrays.stream(greetings).reduce(new ComparString()).get();
        System.out.println(str);
    }
}
/*
안녕하세요~~~~~
안녕하세요~~~~~
*/
```

## 스트림을 활용하여 여행객의 여행 비용 계산하기

```java
package stream.traval;

import java.util.ArrayList;
import java.util.List;

/**
 * 15세이상은 100만원 미만은 50만원
 */
public class TravelTest {
    public static void main(String[] args) {
        TravelCustomer customerLee = new TravelCustomer("이순신", 40, 100);
        TravelCustomer customerKim = new TravelCustomer("김유신", 23, 100);
        TravelCustomer customerHong = new TravelCustomer("홍길동", 13, 50);

        List<TravelCustomer> customerList = new ArrayList<>();
        customerList.add(customerLee);
        customerList.add(customerKim);
        customerList.add(customerHong);

        System.out.println("== 고객 명단 추가된 순서대로 출력 ==");
        customerList.stream().map(c -> c.getName()).forEach(s -> System.out.println(s));

        int total = customerList.stream().mapToInt(c -> c.getPrice()).sum();
        System.out.println("총 여행 비용은 : " + total + "입니다.");

        System.out.println("== 20세 이상 고객 명단 정렬 ==");
        customerList.stream().filter(c->c.getAge() >= 20).map(c->c.getName()).sorted().forEach(s-> System.out.println(s));
    }
}

/*
== 고객 명단 추가된 순서대로 출력 ==
이순신
김유신
홍길동
총 여행 비용은 : 250입니다.
== 20세 이상 고객 명단 정렬 ==
김유신
이순신
*/
```

## 