# 8-2. 상속과 다형성 - super, 형변환

## 상속에서 클래스 생성과 형 변환

- 하위 클래스가 생성될 때는 상위 클래스의 생성자가 먼저 호출됩니다.

### 하위 클래스가 생성되는 과정

- 상속 받은 하위 클래스는 상위 클래스의 멤버 변수와 메소드를 사용할 수 있습니다.
- 하위 클래스가 생성 되는 과정 확인하기
  - 하위 클래스 인스턴스가 생성될 때 상위 클래스의 생성자를 호출 하는 것을 알 수 있습니다.
  - **주의사항: 상위 클래스의 private 멤버 변수는 하위 클래스를 호출 할 때 메모리 공간이 할당되지만, 접근할 수는 없습니다.**

```java
//상위 클래스 Customer의 생성자 수정
 public Customer(){
        customerGrade = "SILVER"; //기본 등급
        bonusRatio = 0.01; //보너스 포인트 기본 적립 비용
        //하위 클래스가 생성될 때 상위 클래스의 생성자를 호출 하는 것을 확인하는 코드
        System.out.println("Customer() 생성자 호출");
    }

//하위 클래스 VIPCustomer의 생성자 수정
public VIPCustomer(){
        customerGrade = "VIP"; //고객 등급 VIP
        bonusRatio = 0.05; //보너스 적립 5%
        saleRatio = 0.1; //할인율 10%
        //하위 클래스를 생성할 때 출력
        System.out.println("VIPCustomer() 생성자 호출");
    }

//테스트
    public static void main(String[] args) {
        VIPCustomer customKim = new VIPCustomer();
        customKim.setCustomerID(10020);
        customKim.setCustomerName("김유신");
        customKim.bonusPoint = 1000;
        System.out.println(customKim.showCustomerInfo());
    }

/*
Customer() 생성자 호출
VIPCustomer() 생성자 호출
김유신 님의 등급은 VIP이며, 보너스 포인트는 1000입니다.
*/
```

## Super 부모를 부르는 예약어

- 하위 클래스에서 상위 클래스로 접근할 때 사용
  - 하위 클래스는 상위 클래스의 주소(참조 값)를 알고 있습니다.
  - super는 참조 값을 가지고 있는 예약어입니다.
    - this는 자기 자신의 참조 값을 가지고 있는 것과 유사하다고 생각하시면 됩니다.
- 상위 클래스 생성자 호출하기
  - 하위 클래스 생성자만 호출해도 자동으로 super()를 호출 하기 때문에 상위 클래스의 default 생성자를 호출합니다.
    - 자동으로 super()호출 : 컴파일러가 수행

```java
public VIPCustomer(){
  super(); //컴파일러가 자동으로 추가하는 코드
  customerGrade = "VIP";
  bonusRatio = 0.05;
  saleRatio = 0.1;
  System.out.println("VIPCustomer() 생성자 호출");
}
```

- super 예약어로 디폴트 생성자가 아닌, 매개 변수가 있는 생성자 호출하기

```java
//Customer
	//디폴트 생성자는 주석처리 혹은 삭제
//    public Customer(){
//        customerGrade = "SILVER"; //기본 등급
//        bonusRatio = 0.01; //보너스 포인트 기본 적립 비용
//        //하위 클래스가 생성될 때 상위 클래스의 생성자를 호출 하는 것을 확인하는 코드
//        System.out.println("Customer() 생성자 호출");
//    }

//매개변수가 있는 생성자 추가
    public Customer(int customerID, String customerName){
        this.customerID = customerID;
        this.customerName = customerName;
        customerGrade = "SILVER";
        bonusRatio = 0.01;
        System.out.println("Customer(int, String) 생성자 호출");
    }

//VIPCustomer
//    public VIPCustomer(){
//        customerGrade = "VIP"; //고객 등급 VIP
//        bonusRatio = 0.05; //보너스 적립 5%
//        saleRatio = 0.1; //할인율 10%
//        //하위 클래스를 생성할 때 출력
//        System.out.println("VIPCustomer() 생성자 호출");
//    }
    public VIPCustomer(int customerID, String customerName, int agentID){
	     //상위 클래스 생성자 호출
        super(customerID, customerName);
        customerGrade = "VIP"; //고객 등급 VIP
        bonusRatio = 0.05; //보너스 적립 5%
        saleRatio = 0.1; //할인율 10%
        this.agentID = agentID;
        //하위 클래스를 생성할 때 출력
        System.out.println("VIPCustomer(int, String) 생성자 호출");
    }

//CustomerTest
public static void main(String[] args) {
        VIPCustomer customKim = new VIPCustomer(10020, "김유신", 90001);
  //생성자에서 값을 넣어주므로 setter가 필요 없어진다.
//        customKim.setCustomerID(10020);
//        customKim.setCustomerName("김유신");
        customKim.bonusPoint = 1000;
        System.out.println(customKim.showCustomerInfo());
    }
```

- 상위 클래스의 멤버 변수나 메소드를 참조하는 super

```java
//상위 클래스의 showCustomerInof()를 이용해 상담원ID를 함께 출력하는 경우
public String showVIPInfo(){
  return super.showCustomerInfo() + "담당 상담원 아이디는" + agentID + "입니다.";
}
```

## 자바의 정석 Super 예

```java
public class SuperTest {
    public static void main(String[] args) {
        Child c = new Child();
        c.method();
    }
}

class Parent{
    int x = 10;
}

class Child extends Parent{
    void method(){
        System.out.println("x=" + x);
        System.out.println("this.x=" + this.x);
        System.out.println("super.x=" + super.x);
    }
}


/*===================================================================*/

public class SuperTest2 {
    public static void main(String[] args) {
        Child2 c = new Child2();
        c.method();
    }

}

class Parent2{
    int x = 10;
}

class Child2 extends Parent2{
    int x = 20;

    void method(){
        System.out.println("x=" + x);
        System.out.println("this.x=" + this.x);
        System.out.println("super.x=" + super.x);
    }
}
```



## 상위 클래스로 묵시적 클래스 형 변환

- 상위클래스인 Customer는 조금 더 일반적인 개념
- 하위클래스인 VIPCustomer는 더 많은 기능 구현
- **상위 클래스 타입으로 선언하여 하위 클래스의 인스턴스를 만들 수는 있지만, 반대로 하위 클래스 타입으로 선언하여 상위 클래스의 인스턴스를 만들 수 없습니다.**

```java
Customer vc = new VIPCustomer();
```

